{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/actions/action-types.ts","webpack:///./src/store/constants.ts","webpack:///./node_modules/symbol-observable/es/index.js","webpack:///./src/store/pieuwer-reducer.ts","webpack:///./node_modules/symbol-observable/es/ponyfill.js","webpack:///./src/phyz/boxes.ts","webpack:///./src/phyz/shapes.ts","webpack:///./src/phyz/collisions.ts","webpack:///./src/actions/action-creators.ts","webpack:///./src/store/explosion-reducer.ts","webpack:///./src/store/enemy-reducer.ts","webpack:///./src/store/bullet-reducer.ts","webpack:///./src/phyz/guard-number.ts","webpack:///./src/store/reducers.ts","webpack:///./src/draw.ts","webpack:///./src/resizable-canvas/event-listeners.ts","webpack:///./src/resizable-canvas/viewport.ts","webpack:///./src/resizable-canvas/resize-listeners.ts","webpack:///./src/resizable-canvas/frame-renderer.ts","webpack:///./node_modules/padevents/src/index.js","webpack:///(webpack)/buildin/harmony-module.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/redux/es/redux.js","webpack:///./src/index.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ActionTypes","VIRT_WIDTH","VIRT_HEIGHT","ENEMY_WIDTH","ENEMY_HEIGHT","root","_ponyfill_js__WEBPACK_IMPORTED_MODULE_0__","self","window","global","result","__webpack_exports__","PieuwerControl","action_types_1","constants_1","guard_number_1","initializePieuwerState","xPos","accelerateLeft","accelerateRight","accelerateUp","accelerateDown","angle","ySpeed","shooting","health","collisionShapes","pos","x","y","size","initialState","pieuwerOne","pieuwerTwo","updatePieuwerState","pieuwerState","__assign","guardNumber","Math","round","setPieuwerState","pieuwer","val","_a","_b","default","state","action","type","KEYUP","UP","player","DOWN","LEFT","RIGHT","SHOOT","KEYDOWN","UPDATE","symbolObservablePonyfill","observable","pointWithinBox","bL","bT","w","h","boxesOverlap","b1","b2","isBox","shape","isCircle","shapes_1","boxes_1","pointWithinAreaList","shapes","map","sqrt","pow","radius","pointWithinCircle","filter","length","translateToEnemyOrigin","bullet","enemy","rotateToEnemyAngle","cos","sin","detectBulletToEnemyCollisions","bullets","bulletStates","enemies","enemyStates","bulletIdx","en","idx","enemyIdx","PI","enemyCollidesWithBullet","collsionPos","pieuwer_reducer_1","KeyboardToPlayerControlMap","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","0","a","KeyboardToPieuwerControlMap","GamepadToPieuwerControlMap","up","down","left","right","enemyActionCreator","dispatch","spawnEnemy","yPos","SPAWN_ENEMY","spawn","maxHealth","makeEnemy","enemiesReceiveBullet","forEach","ENEMY_RECEIVES_BULLET","explosionActionCreator","spawnExplosion","SPAWN_EXPLOSION","bulletActionCreator","spawnBullet","trajectory","SPAWN_BULLET","keyActionCreator","onKeyDown","onKeyUp","onGamePadButtonDown","onGamePadButtonUp","explosions","explode","explosion","concat","initSize","fly","enemyState","withinBounds","newNum","maxNum","minNum","bullet_reducer_1","enemy_reducer_1","explosion_reducer_1","pieuwerStates","explosionStates","pieuwerOnePng","Image","src","pieuwerTwoPng","enemyPng","pieuwerPngs","preload","callback","complete","setTimeout","drawPieuwer","pieuwerKey","ps","ctx","scale","save","translate","rotate","drawImage","restore","drawBullet","bs","beginPath","fillStyle","arc","fill","drawEnemy","globalAlpha","strokeStyle","drawExplosion","registered","onResize","add","eventName","onEvent","elem","fn","ev","push","addEventListener","clear","removeEventListener","vWidth","vHeight","listeners","aspectRatio","invokeListeners","width","height","listener","innerWidth","innerHeight","floor","canvases","_i","arguments","canvas","style","top","can","clearRequested","render","drawables","clearRect","draw","initPadEvents","onUnmappedButton","onControllersChange","axisMappings","1","2","3","defaultMappings","9","8","5","7","4","6","10","11","12","13","14","15","padEvents","reduce","acc","cur","pressed","released","controllers","keymaps","buttonstates","axisStates","axisCalibrations","roundOffAxisValue","axis","calibrateAxisValue","calib","rounded","registerController","gamepad","index","assign","keymap","keys","initButtonStates","axes","dispatchPadEvents","controller","j","current","axName","dir","dispatchEvent","CustomEvent","detail","controllerIndex","force","measured","abs","buttons","buttonMapping","requestAnimationFrame","setInterval","gamepads","navigator","getGamepads","webkitGetGamepads","b","originalModule","webpackPolyfill","children","g","this","Function","eval","e","INIT","random","toString","substring","split","join","REPLACE","_typeof","iterator","obj","constructor","_extends","target","source","isPlainObject","proto","getPrototypeOf","createStore","reducer","preloadedState","enhancer","_ref2","undefined","Error","currentReducer","currentState","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","slice","getState","subscribe","isSubscribed","indexOf","splice","replaceReducer","nextReducer","symbol_observable__WEBPACK_IMPORTED_MODULE_0__","_ref","outerSubscribe","observer","TypeError","observeState","next","unsubscribe","getUndefinedStateErrorMessage","actionType","String","combineReducers","reducers","reducerKeys","finalReducers","finalReducerKeys","shapeAssertionError","assertReducerShape","hasChanged","nextState","_key","previousStateForKey","nextStateForKey","errorMessage","bindActionCreator","actionCreator","apply","bindActionCreators","actionCreators","boundActionCreators","compose","_len","funcs","Array","arg","applyMiddleware","middlewares","_len2","args","_key2","store","_dispatch","middlewareAPI","chain","middleware","redux_1","padevents_1","frame_renderer_1","resize_listeners_1","viewport_1","event_listeners_1","draw_1","reducers_1","action_creators_1","collisions_1","mainLayer","document","getElementById","HTMLCanvasElement","mainLayerCtx","getContext","mainFrameRenderer","gamePadToPlayerMap","controllerIds","eventListeners","k","handleBulletEnemyCollision","params","renderLoop"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n","export enum ActionTypes {\n  KEYDOWN,\n  KEYUP,\n  UPDATE,\n  SPAWN_BULLET,\n  SPAWN_ENEMY,\n  SPAWN_EXPLOSION,\n  ENEMY_RECEIVES_BULLET\n}\n","export const VIRT_WIDTH = 1600;\nexport const VIRT_HEIGHT = 1000;\nexport const ENEMY_WIDTH = 100;\nexport const ENEMY_HEIGHT = 160;\n","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","import { ActionTypes  } from \"../actions/action-types\";\nimport { AnyAction } from \"redux\";\nimport { VIRT_WIDTH, VIRT_HEIGHT } from \"./constants\";\nimport { KeyAction } from \"../actions/action-creators\";\nimport { Point, Box, Circle } from \"../phyz/shapes\";\nimport { guardNumber } from \"../phyz/guard-number\";\n\nconst yAcceleration = 0.25;\nconst maxYSpeed = 3;\nconst minYSpeed = -1.5;\n\nconst turnAcceleration = 1.5;\nconst maxAngle = 15;\nconst minAngle = -15;\n\ntype stateKey = \"accelerateUp\"|\"accelerateDown\"|\"accelerateLeft\"|\"accelerateRight\"|\"shooting\";\nexport type PieuwerKey = \"pieuwerOne\"|\"pieuwerTwo\";\n\nexport enum PieuwerControl {\n  UP, DOWN, LEFT, RIGHT, SHOOT\n}\n\n\nexport interface PieuwerState {\n  accelerateUp: boolean\n  accelerateDown: boolean\n  accelerateLeft: boolean\n  accelerateRight: boolean\n  collisionShapes: Array<Box|Circle>\n  angle: number\n  ySpeed: number\n  pos: Point\n  size: Point\n  shooting: boolean\n  health: number\n}\n\nexport interface MultiPieuwerState {\n  pieuwerOne: PieuwerState\n  pieuwerTwo: PieuwerState\n}\n\nconst initializePieuwerState = (xPos : number) : PieuwerState => ({\n  accelerateLeft: false, accelerateRight: false,\n  accelerateUp: false, accelerateDown: false,\n  angle: 0, ySpeed: 0, shooting: false,\n  health: 100,\n  collisionShapes: [\n    /* TODO */\n  ],\n  pos: {x: xPos, y: VIRT_HEIGHT - 150},\n  size: {x: 240, y: 240}\n});\n\nconst initialState : MultiPieuwerState  = {\n  pieuwerOne: initializePieuwerState(200),\n  pieuwerTwo: initializePieuwerState(VIRT_WIDTH - 200)\n};\n\nconst updatePieuwerState = (pieuwerState : PieuwerState) : PieuwerState => ({\n    ...pieuwerState,\n    ySpeed: pieuwerState.accelerateUp\n      ? guardNumber(pieuwerState.ySpeed + yAcceleration, maxYSpeed, minYSpeed)\n      : pieuwerState.accelerateDown\n      ? guardNumber(pieuwerState.ySpeed - yAcceleration, maxYSpeed, minYSpeed)\n      : pieuwerState.ySpeed < 0\n      ? guardNumber(pieuwerState.ySpeed + yAcceleration, 0, minYSpeed)\n      : pieuwerState.ySpeed > 0\n      ? guardNumber(pieuwerState.ySpeed - yAcceleration, maxYSpeed, 0)\n      : 0,\n\n    angle: pieuwerState.accelerateLeft\n      ? guardNumber(pieuwerState.angle - turnAcceleration, maxAngle, minAngle)\n      : pieuwerState.accelerateRight\n      ? guardNumber(pieuwerState.angle + turnAcceleration, maxAngle, minAngle)\n      : pieuwerState.angle < 0\n      ? guardNumber(pieuwerState.angle + turnAcceleration, 0, minAngle)\n      : pieuwerState.angle > 0\n      ? guardNumber(pieuwerState.angle - turnAcceleration, maxAngle, 0)\n      : 0,\n\n    pos: {\n      y: guardNumber(Math.round(pieuwerState.pos.y - pieuwerState.ySpeed), VIRT_HEIGHT, 0),\n      x: guardNumber(Math.round(pieuwerState.pos.x + pieuwerState.angle * 0.2), VIRT_WIDTH, 0)\n    }\n});\n\nconst setPieuwerState = (pieuwerState : MultiPieuwerState, pieuwer : PieuwerKey, key : stateKey, val : boolean) : MultiPieuwerState => ({\n    ...pieuwerState,\n    [pieuwer] : {\n      ...pieuwerState[pieuwer],\n      [key]: val\n    }\n});\n\nexport default function(state : MultiPieuwerState, action : KeyAction) {\n  if (typeof state === 'undefined') {\n    return initialState;\n  }\n  switch (action.type) {\n    case ActionTypes.KEYUP:\n      switch (action.key) {\n        case PieuwerControl.UP:\n          return setPieuwerState(state, action.player, \"accelerateUp\", false);\n        case PieuwerControl.DOWN:\n          return setPieuwerState(state, action.player, \"accelerateDown\", false);\n        case PieuwerControl.LEFT:\n          return setPieuwerState(state, action.player, \"accelerateLeft\", false);\n        case PieuwerControl.RIGHT:\n          return setPieuwerState(state, action.player, \"accelerateRight\", false);\n        case PieuwerControl.SHOOT:\n          return setPieuwerState(state, action.player, \"shooting\", false);\n        default:\n          return state;\n      }\n\n    case ActionTypes.KEYDOWN:\n      switch (action.key) {\n        case PieuwerControl.UP:\n          return setPieuwerState(state, action.player, \"accelerateUp\", true);\n        case PieuwerControl.DOWN:\n          return setPieuwerState(state, action.player, \"accelerateDown\", true);\n        case PieuwerControl.LEFT:\n          return setPieuwerState(state, action.player, \"accelerateLeft\", true);\n        case PieuwerControl.RIGHT:\n          return setPieuwerState(state, action.player, \"accelerateRight\", true);\n        case PieuwerControl.SHOOT:\n          return setPieuwerState(state, action.player, \"shooting\", true);\n        default:\n          return state;\n      }\n    case ActionTypes.UPDATE:\n      return {\n        pieuwerOne: updatePieuwerState(state.pieuwerOne),\n        pieuwerTwo: updatePieuwerState(state.pieuwerTwo)\n      };\n    default:\n      return state;\n  }\n}\n","export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","import { Box, Point } from \"./shapes\";\n\nexport const pointWithinBox : (p : Point, b: Box) => boolean = ({x, y}, {x : bL, y : bT, w, h}) =>\n  x >= bL && x <= bL + w && y >= bT && y <= bT + h\n\n\nexport const boxesOverlap = (b1 : Box, b2: Box) : boolean  =>\n    // b1 within b2?\n    pointWithinBox({x: b1.x,        y: b1.y},        b2) || // topLeft\n    pointWithinBox({x: b1.x + b1.w, y: b1.y},        b2) || // topRight\n    pointWithinBox({x: b1.x,        y: b1.y + b1.h}, b2) || // bottomLeft\n    pointWithinBox({x: b1.x + b1.w, y: b1.y + b1.h}, b2) || // bottomRight\n    // b2 within b1?\n    pointWithinBox({x: b2.x,        y: b2.y},        b1) || // topLeft\n    pointWithinBox({x: b2.x + b2.w, y: b2.y},        b1) || // topRight\n    pointWithinBox({x: b2.x,        y: b2.y + b2.h}, b1) || // bottomLeft\n    pointWithinBox({x: b2.x + b2.w, y: b2.y + b2.h}, b1); // bottomRight\n","export interface Point {\n  x: number,\n  y: number\n}\n\nexport interface Box extends Point {\n  w: number,\n  h: number\n}\n\nexport interface Circle extends Point {\n  radius: number\n}\n\nexport const isBox = (shape : Box|Circle) => 'w' in shape;\nexport const isCircle = (shape : Box|Circle) => 'radius' in shape;\n","import { BulletState } from \"../store/bullet-reducer\";\nimport { GameState } from \"../store/reducers\";\nimport { EnemyState } from \"../store/enemy-reducer\";\nimport { Point, Box, Circle, isBox } from \"./shapes\";\nimport { pointWithinBox } from \"./boxes\";\n\nconst pointWithinCircle = (pos : Point, c : Circle) : boolean =>\n  Math.sqrt(Math.pow(pos.x - c.x, 2) + Math.pow(pos.y - c.y, 2)) <= c.radius;\n\nconst pointWithinAreaList = (p : Point, shapes : Array<Circle|Box>) : boolean =>\n  shapes.map(shape => isBox(shape) ? pointWithinBox(p, <Box>shape) : pointWithinCircle(p, <Circle>shape))\n    .filter(result => result)\n    .length > 0;\n\nconst translateToEnemyOrigin = (bullet : BulletState, enemy: EnemyState) : Point => ({\n  x: bullet.pos.x - enemy.pos.x,\n  y: bullet.pos.y - enemy.pos.y\n});\n//enemy.angle * Math.PI / 180\nconst rotateToEnemyAngle = (p : Point, angle : number) => ({\n  x: p.x * Math.cos(angle) - p.y * Math.sin(angle),\n  y: p.x * Math.sin(angle) + p.y * Math.cos(angle)\n});\n\n\nconst enemyCollidesWithBullet = (bullet : BulletState, enemy: EnemyState) : boolean =>\n    pointWithinBox(rotateToEnemyAngle(translateToEnemyOrigin(bullet, enemy), -enemy.angle  * Math.PI / 180), {\n      x: -enemy.size.x / 2,\n      y: -enemy.size.y / 2,\n      w: enemy.size.x,\n      h: enemy.size.y\n    }) && pointWithinAreaList(rotateToEnemyAngle(translateToEnemyOrigin(bullet, enemy), -enemy.angle  * Math.PI / 180), enemy.collisionShapes);\n\n/* PREMATURE OPTIM.\nconst bulletToCollisionKey = (bullet : BulletState) : string =>\n  `${Math.floor(bullet.pos.x / COLLISION_GRID_SIZE) * COLLISION_GRID_SIZE}-${Math.floor(bullet.pos.y / COLLISION_GRID_SIZE) *  COLLISION_GRID_SIZE}`;\n*/\n\nexport const detectBulletToEnemyCollisions : (s : GameState) => Array<{enemies: Array<number>, bulletIdx : number, collsionPos: Point}> =\n  ({ bulletStates : { bullets }, enemyStates : { enemies } }) =>\n  bullets.map((bullet, bulletIdx) => ({\n    enemies: /* (collisionGrid[bulletToCollisionKey(bullet)]||[]) */\n      enemies.map((en, idx) => idx)\n      .filter((enemyIdx) => enemyCollidesWithBullet(bullet, enemies[enemyIdx])),\n    bulletIdx: bulletIdx,\n    collsionPos: { x: bullet.pos.x, y: bullet.pos.y }\n  }))\n  .filter(({enemies, bulletIdx}) => enemies.length > 0)\n","import { Dispatch, AnyAction } from \"redux\";\nimport { ActionTypes } from \"./action-types\";\nimport { PieuwerControl, PieuwerKey, PieuwerState } from \"../store/pieuwer-reducer\";\nimport { EnemyState } from \"../store/enemy-reducer\";\nimport { Point } from \"../phyz/shapes\";\nimport { ENEMY_WIDTH, ENEMY_HEIGHT } from \"../store/constants\";\n\n\n\nconst KeyboardToPlayerControlMap : {[key: string]: PieuwerKey } = {\n  ArrowUp: \"pieuwerOne\",\n  ArrowDown: \"pieuwerOne\",\n  ArrowLeft: \"pieuwerOne\",\n  ArrowRight: \"pieuwerOne\",\n  \"0\": \"pieuwerOne\",\n  w: \"pieuwerTwo\",\n  s: \"pieuwerTwo\",\n  a: \"pieuwerTwo\",\n  d: \"pieuwerTwo\",\n  c: \"pieuwerTwo\"\n};\n\nconst KeyboardToPieuwerControlMap : {[key: string]: PieuwerControl} = {\n  ArrowUp: PieuwerControl.UP,\n  ArrowDown: PieuwerControl.DOWN,\n  ArrowLeft: PieuwerControl.LEFT,\n  ArrowRight: PieuwerControl.RIGHT,\n  \"0\": PieuwerControl.SHOOT,\n  w: PieuwerControl.UP,\n  s: PieuwerControl.DOWN,\n  a: PieuwerControl.LEFT,\n  d: PieuwerControl.RIGHT,\n  c: PieuwerControl.SHOOT\n};\n\nconst GamepadToPieuwerControlMap : {[key: string]: PieuwerControl} = {\n  a: PieuwerControl.SHOOT,\n  up: PieuwerControl.UP,\n  down: PieuwerControl.DOWN,\n  left: PieuwerControl.LEFT,\n  right: PieuwerControl.RIGHT,\n};\n\nexport interface KeyAction  {\n  type: ActionTypes\n  key: PieuwerControl\n  player: PieuwerKey\n}\n\nexport interface BulletAction {\n  type: ActionTypes\n  xPos?: number\n  yPos?: number\n  trajectory?: number\n  bulletIdx?: number\n}\n\nexport interface EnemyAction {\n  type: ActionTypes\n  spawn?: EnemyState\n  enemyIdx?: number\n}\n\nexport interface ExplosionAction {\n  type: ActionTypes,\n  pos: Point\n  size: number\n}\n\n\nconst makeEnemy = (xPos : number, yPos : number, size: Point, health? : number) : EnemyState => ({\n  accelerateLeft: false, accelerateRight: false,\n  accelerateUp: false, accelerateDown: false,\n  angle: 0, ySpeed: 0, shooting: false,\n  size: size,\n  collisionShapes: [\n    {\n      x: (4 -  (ENEMY_WIDTH  / 2)) * (size.x / ENEMY_WIDTH),\n      y: (63 - (ENEMY_HEIGHT / 2)) * (size.y / ENEMY_HEIGHT),\n      w: 26 * (size.x / ENEMY_WIDTH),\n      h: 95 * (size.y / ENEMY_HEIGHT)\n    },\n    {\n      x: (30 -  (ENEMY_WIDTH  / 2)) * (size.x / ENEMY_WIDTH),\n      y: (63 - (ENEMY_HEIGHT / 2)) * (size.y / ENEMY_HEIGHT),\n      w: 51 * (size.x / ENEMY_WIDTH),\n      h: 82 * (size.y / ENEMY_HEIGHT)\n    },\n    {\n      x: (58 -  (ENEMY_WIDTH  / 2)) * (size.x / ENEMY_WIDTH),\n      y: (42 - (ENEMY_HEIGHT / 2)) * (size.y / ENEMY_HEIGHT),\n      radius: 40 * (size.x / ENEMY_WIDTH)\n    },\n    {\n      x: (27 -  (ENEMY_WIDTH  / 2)) * (size.x / ENEMY_WIDTH),\n      y: (50 - (ENEMY_HEIGHT / 2)) * (size.y / ENEMY_HEIGHT),\n      radius: 20 * (size.x / ENEMY_WIDTH)\n    }\n  ],\n  health: health || 4, maxHealth: health || 4,\n  pos: {y: yPos, x: xPos}\n});\n\nexport const enemyActionCreator = (dispatch : Dispatch<EnemyAction|BulletAction>) => ({\n  spawnEnemy: (xPos : number, yPos : number, size: Point, health? : number) => {\n    dispatch({type: ActionTypes.SPAWN_ENEMY, spawn: makeEnemy(xPos, yPos, size, health)})\n  },\n  enemiesReceiveBullet: ({bulletIdx, enemies} : {bulletIdx : number, enemies: Array<number>}) => {\n    enemies.forEach(enemyIdx => dispatch({type: ActionTypes.ENEMY_RECEIVES_BULLET, enemyIdx: enemyIdx, bulletIdx: bulletIdx}));\n  }\n});\n\nexport const explosionActionCreator = (dispatch : Dispatch<ExplosionAction>) => ({\n  spawnExplosion: (pos : Point, size: number) => {\n    dispatch({type: ActionTypes.SPAWN_EXPLOSION, pos: pos, size: size});\n  }\n})\n\nexport const bulletActionCreator = (dispatch : Dispatch<BulletAction>) => ({\n  spawnBullet: (pieuwer : PieuwerState) =>  {\n    if (pieuwer.shooting) {\n      const trajectory = (pieuwer.angle - 90) * (Math.PI / 180);\n      dispatch({\n        type: ActionTypes.SPAWN_BULLET,\n        xPos: pieuwer.pos.x + Math.cos(trajectory) * 120,\n        yPos: pieuwer.pos.y + Math.sin(trajectory) * 120,\n        trajectory: trajectory\n      });\n    }\n  }\n});\n\nexport const keyActionCreator = (dispatch : Dispatch<KeyAction>) => ({\n  onKeyDown: (key : string) => dispatch({type: ActionTypes.KEYDOWN, key: KeyboardToPieuwerControlMap[key], player: KeyboardToPlayerControlMap[key]}),\n  onKeyUp: (key : string) => dispatch({type: ActionTypes.KEYUP, key: KeyboardToPieuwerControlMap[key], player: KeyboardToPlayerControlMap[key]}),\n  onGamePadButtonDown: (key : string, player : PieuwerKey) => dispatch({type: ActionTypes.KEYDOWN, key: GamepadToPieuwerControlMap[key], player: player}),\n  onGamePadButtonUp: (key : string, player : PieuwerKey) => dispatch({type: ActionTypes.KEYUP, key: GamepadToPieuwerControlMap[key], player: player}),\n});\n","import { ActionTypes  } from \"../actions/action-types\";\nimport { AnyAction } from \"redux\";\nimport { VIRT_WIDTH, VIRT_HEIGHT } from \"./constants\";\nimport { KeyAction, BulletAction, ExplosionAction } from \"../actions/action-creators\";\nimport { Point } from \"../phyz/shapes\";\n\n\nexport interface ExplosionState {\n  pos: Point\n  size: number,\n  initSize: number\n}\n\nexport interface MultiExplosionState {\n  explosions: Array<ExplosionState>\n}\n\n\nconst initialState : MultiExplosionState  = {\n  explosions: []\n};\n\nconst explode = (explosion : ExplosionState) : ExplosionState => ({\n  ...explosion,\n  size: explosion.size - 1\n});\n\n\nexport default function(state : MultiExplosionState, action : ExplosionAction) : MultiExplosionState {\n  if (typeof state === 'undefined') {\n    return initialState;\n  }\n  switch (action.type) {\n    case ActionTypes.SPAWN_EXPLOSION:\n      return {\n        explosions: state.explosions.concat({\n          size: action.size,\n          initSize: action.size,\n          pos: action.pos,\n        })\n      };\n    case ActionTypes.UPDATE:\n      return {\n        explosions: state.explosions\n          .map(explode)\n          .filter(explosion => explosion.size > 0)\n      };\n    default:\n      return state;\n  }\n}\n","import { ActionTypes } from \"../actions/action-types\";\nimport { PieuwerState } from \"./pieuwer-reducer\";\nimport { EnemyAction } from \"../actions/action-creators\";\nimport { VIRT_HEIGHT, VIRT_WIDTH } from \"./constants\";\nimport { pointWithinBox, boxesOverlap } from \"../phyz/boxes\";\nimport { Box } from \"../phyz/shapes\";\n\nexport interface EnemyState extends PieuwerState {\n  maxHealth: number\n}\n\n\nexport interface MultiEnemyState {\n  enemies: Array<EnemyState>\n}\n\n\nconst initialState : MultiEnemyState =  {\n  enemies: [],\n}\n\nconst fly = (enemyState : EnemyState) : EnemyState => ({\n  ...enemyState,\n  angle: enemyState.angle + 0.1 >= 360 ? 0 : enemyState.angle + 0.1\n});\n\nexport default function(state : MultiEnemyState, action : EnemyAction) : MultiEnemyState {\n  if (typeof state === 'undefined') {\n    return initialState;\n  }\n  let newState = state;\n  switch (action.type) {\n    case ActionTypes.ENEMY_RECEIVES_BULLET:\n      return {\n        ...state,\n        enemies: state.enemies.map((enemy, idx) => ({\n          ...enemy,\n          health: idx === action.enemyIdx ? enemy.health - 1 : enemy.health\n        })).filter((enemy) => enemy.health > 0)\n      };\n    case ActionTypes.SPAWN_ENEMY:\n      return {\n        ...state,\n        enemies: state.enemies.concat(action.spawn)\n      };\n      break;\n    case ActionTypes.UPDATE:\n      return {\n        ...state,\n        enemies: state.enemies.map(fly)\n      };\n      break;\n    default:\n      return state;\n  }\n}\n","import { ActionTypes  } from \"../actions/action-types\";\nimport { AnyAction } from \"redux\";\nimport { VIRT_WIDTH, VIRT_HEIGHT } from \"./constants\";\nimport { KeyAction, BulletAction } from \"../actions/action-creators\";\nimport { Point } from \"../phyz/shapes\";\n\n\nexport interface BulletState {\n  trajectory: number\n  pos: Point\n}\n\nexport interface MultiBulletState {\n  bullets: Array<BulletState>\n}\n\n\nconst initialState : MultiBulletState  = {\n  bullets: []\n};\n\nconst fly = (bullet : BulletState) : BulletState => ({\n  ...bullet,\n  pos: {\n    x: bullet.pos.x + Math.cos(bullet.trajectory) * 10,\n    y: bullet.pos.y + Math.sin(bullet.trajectory) * 10\n  }\n});\n\nconst withinBounds = (bullet : BulletState) : boolean  =>\n  bullet.pos.x > 0 && bullet.pos.x < VIRT_WIDTH && bullet.pos.y > 0 && bullet.pos.y < VIRT_HEIGHT;\n\nexport default function(state : MultiBulletState, action : BulletAction) : MultiBulletState {\n  if (typeof state === 'undefined') {\n    return initialState;\n  }\n  switch (action.type) {\n    case ActionTypes.ENEMY_RECEIVES_BULLET:\n    return {\n      bullets: state.bullets.filter((bullet, idx) => idx !== action.bulletIdx)\n    };\n    case ActionTypes.SPAWN_BULLET:\n      return {\n        bullets: state.bullets.concat({\n          pos: { x: action.xPos, y: action.yPos },\n          trajectory: action.trajectory\n        })\n      };\n    case ActionTypes.UPDATE:\n      return {\n        bullets: state.bullets\n          .map(fly)\n          .filter(withinBounds)\n      };\n    default:\n      return state;\n  }\n}\n","export const guardNumber = (newNum : number, maxNum : number, minNum : number) : number =>\n  newNum > maxNum ? maxNum  : newNum < minNum ? minNum : newNum;\n","import pieuwerReducer, { MultiPieuwerState } from \"./pieuwer-reducer\";\nimport bulletReducer, { MultiBulletState } from \"./bullet-reducer\";\nimport enemyReducer, { MultiEnemyState } from \"./enemy-reducer\";\nimport explosionReducer, { MultiExplosionState } from \"./explosion-reducer\";\n\nexport default {\n  pieuwerStates: pieuwerReducer,\n  bulletStates: bulletReducer,\n  explosionStates: explosionReducer,\n  enemyStates: enemyReducer\n}\n\nexport interface GameState {\n  pieuwerStates: MultiPieuwerState\n  bulletStates: MultiBulletState\n  explosionStates: MultiExplosionState\n  enemyStates: MultiEnemyState\n}\n","import { BulletState } from \"./store/bullet-reducer\";\nimport { Drawable } from \"./resizable-canvas/drawable\";\nimport { PieuwerState, PieuwerKey } from \"./store/pieuwer-reducer\";\nimport { EnemyState } from \"./store/enemy-reducer\";\nimport { ExplosionState } from \"./store/explosion-reducer\";\nimport { isBox, Box, Circle } from \"./phyz/shapes\";\nimport { ENEMY_WIDTH, ENEMY_HEIGHT } from \"./store/constants\";\n\n\nconst pieuwerOnePng = new Image();\npieuwerOnePng.src = \"./img/pieuwerOne.png\";\nconst pieuwerTwoPng = new Image();\npieuwerTwoPng.src = \"./img/pieuwerTwo.png\";\nconst enemyPng = new Image();\nenemyPng.src = \"./img/enemy.png\";\n\nconst pieuwerPngs : {[key : string] : HTMLImageElement} = {\n  pieuwerOne: pieuwerOnePng,\n  pieuwerTwo: pieuwerTwoPng\n};\n\nexport function preload(callback : () => void) {\n  if (pieuwerOnePng.complete && pieuwerTwoPng.complete && enemyPng.complete) {\n    callback();\n  } else {\n    setTimeout(() => preload(callback), 1);\n  }\n}\n\nexport const drawPieuwer = (pieuwerKey : PieuwerKey, ps : PieuwerState) : Drawable =>\n  (ctx: CanvasRenderingContext2D, scale: number) => {\n    ctx.save();\n    ctx.translate(ps.pos.x * scale, ps.pos.y * scale);\n    ctx.rotate(ps.angle * Math.PI / 180);\n    ctx.drawImage(pieuwerPngs[pieuwerKey], 0, 0, 240, 240, -120*scale, -120*scale, 240*scale, 240*scale);\n    ctx.restore();\n  };\n\nexport const drawBullet = (bs : BulletState) : Drawable =>\n  (ctx: CanvasRenderingContext2D, scale: number) => {\n      ctx.beginPath();\n      ctx.fillStyle = `rgb(255,255,255)`;\n      ctx.arc(\n        bs.pos.x * scale,\n        bs.pos.y * scale,\n        3 * scale, 0, Math.PI*2\n      );\n      ctx.fill();\n    };\n\nexport const drawEnemy = (enemy : EnemyState) : Drawable =>\n  (ctx: CanvasRenderingContext2D, scale: number) => {\n    ctx.save();\n    ctx.translate(enemy.pos.x * scale, enemy.pos.y * scale);\n    ctx.rotate(enemy.angle * Math.PI / 180);\n    ctx.globalAlpha = (enemy.health / enemy.maxHealth) * 0.5 + 0.5;\n    ctx.strokeStyle = \"white\";\n    ctx.drawImage(enemyPng,0,0, ENEMY_WIDTH, ENEMY_HEIGHT,\n      -(enemy.size.x / 2) * scale,\n      -(enemy.size.y / 2) * scale,\n      enemy.size.x * scale,\n      enemy.size.y * scale);\n    /*DEBUG\n    enemy.collisionShapes.forEach(shape => {\n      if (isBox(shape)) {\n        ctx.strokeRect(\n          shape.x * scale,\n          shape.y * scale,\n          (<Box>shape).w * scale,\n          (<Box>shape).h * scale,\n        );\n      } else {\n        ctx.beginPath();\n        ctx.arc(\n          shape.x * scale,\n          shape.y * scale,\n          (<Circle>shape).radius * scale,\n          0, Math.PI*2\n        );\n        ctx.stroke();\n        ctx.closePath();\n      }\n    });*/\n    ctx.globalAlpha = 1;\n    ctx.restore();\n  };\n\nexport const drawExplosion = (explosion : ExplosionState) =>\n  (ctx: CanvasRenderingContext2D, scale: number) => {\n    ctx.beginPath();\n    ctx.fillStyle = `rgba(255,255,255, ${0.5 + ((explosion.size / explosion.initSize) * 0.5)})`;\n    ctx.arc(\n      explosion.pos.x * scale,\n      explosion.pos.y * scale,\n      5 * scale * (explosion.initSize - explosion.size), 0, Math.PI*2\n    );\n    ctx.fill();\n  };\n","type ScaledEventListener = (ev : Event) => (ev : Event, scale : number) => any;\n\ninterface ScaledEventRegistryEntry {\n  elem: HTMLElement|Window,\n  eventName: string,\n  fn : ScaledEventListener\n};\n\nexport default function() {\n\tlet scale : number;\n\tlet registered : Array<ScaledEventRegistryEntry> = [];\n\n\treturn {\n\t\tonResize(s : number) {\n\t\t\tscale = s;\n\t\t},\n\t\tadd(eventName : string, onEvent : (ev : Event, scale : number) => any, elem : HTMLElement|Window = window) {\n\t\t\tconst fn : ScaledEventListener = (ev : Event) => onEvent(ev, scale);\n\n\t\t\tregistered.push({\n\t\t\t\telem: elem,\n\t\t\t\teventName: eventName,\n\t\t\t\tfn: fn\n\t\t\t});\n\n\t\t\telem.addEventListener(eventName, fn);\n\t\t},\n\t\tclear() {\n\t\t\tregistered.forEach(({elem, eventName, fn}) =>\n\t\t\t\telem.removeEventListener(eventName, fn)\n\t\t\t)\n\t\t}\n\t}\n};\n","export default function(vWidth : number, vHeight : number, listeners : Array<(scale : number, width : number, height : number) => any>) {\n\tconst aspectRatio = vHeight / vWidth;\n\n\tfunction invokeListeners(width : number, height : number, scale : number) {\n\t\tlisteners.forEach(listener =>\tlistener(scale, width, height));\n\t}\n\n\tfunction onResize() {\n\t\tconst { innerWidth, innerHeight } = window;\n\t\tif (innerWidth * aspectRatio > innerHeight) {\n\t\t\tinvokeListeners(Math.floor(innerHeight / aspectRatio), innerHeight, (innerHeight / aspectRatio) / vWidth)\n\t\t} else {\n\t\t\tinvokeListeners(innerWidth, Math.floor(innerWidth * aspectRatio), innerWidth / vWidth)\n\t\t}\n\t}\n\n\tonResize();\n\twindow.addEventListener(\"resize\", onResize);\n}\n","export default (canvases : Array<HTMLCanvasElement>, ...listeners : Array<(scale : number) => void>) => {\n\tfunction rescaleGame(scale : number, width : number, height : number) {\n\t\tcanvases.forEach(canvas => {\n\t\t\tcanvas.style.left = `${Math.floor((window.innerWidth - width) / 2)}px`;\n\t\t\tcanvas.style.top = `${Math.floor((window.innerHeight - height) / 2)}px`;\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\t\t});\n\t}\n\n\treturn [rescaleGame].concat(listeners);\n};\n","import {Drawable} from \"./drawable\";\n\nexport default function(ctx : CanvasRenderingContext2D, can : HTMLCanvasElement) {\n\tlet scale : number;\n\tlet clearRequested : boolean = false;\n\treturn {\n\t\tonResize(s : number) {\n\t\t\tscale = s;\n\t\t},\n\t\tclear() {\n\t\t\tclearRequested = true;\n\t\t},\n\t\trender(drawables : Array<Drawable>) {\n\t\t\tif (clearRequested) {\n\t\t\t\tctx.clearRect(0, 0, can.width, can.height);\n\t\t\t\tclearRequested = false;\n\t\t\t}\n\t\t\tdrawables.forEach(draw => draw(ctx, scale));\n\t\t}\n\t}\n}\n","/*\nconst padEvents = initPadEvents();\nconsole.log(padEvents);\n\nObject.keys(padEvents).forEach((cur) => {\n  window.addEventListener(`gamepad-${cur}-pressed`, (ev) => {\n    console.log(`Controller ${ev.detail.controllerIndex} pressed: ${cur}`)\n    console.log(JSON.stringify(controllers[0].buttons.map(b => b.pressed)))\n  });\n  window.addEventListener(`gamepad-${cur}-released`, (ev) =>\n    console.log(`Controller ${ev.detail.controllerIndex} released: ${cur}`));\n});\n*/\nconst initPadEvents = ({\n    onUnmappedButton, onControllersChange\n  },\n  axisMappings = {\n    \"0\": [\"l-axis\", 0],\n    \"1\": [\"l-axis\", 1],\n    \"2\": [\"r-axis\", 0],\n    \"3\": [\"r-axis\", 1]\n  },\n  defaultMappings = {\n    \"0\": \"x\",\n    \"1\": \"a\",\n    \"2\": \"b\",\n    \"3\": \"y\",\n    \"9\": \"start\",\n    \"8\": \"select\",\n    \"5\": \"rt-shoulder\",\n    \"7\": \"rb-shoulder\",\n    \"4\": \"lt-shoulder\",\n    \"6\": \"lb-shoulder\",\n    \"10\": \"l-axis\",\n    \"11\": \"r-axis\",\n    \"12\": \"up\",\n    \"13\": \"down\",\n    \"14\": \"left\",\n    \"15\": \"right\"}) => {\n\n  const padEvents = [\n    \"a\", \"b\", \"x\", \"y\",\n    \"start\", \"select\", \"up\", \"down\", \"left\", \"right\",\n    \"rt-shoulder\", \"rb-shoulder\",\n    \"lt-shoulder\", \"lb-shoulder\",\n    \"l-axis\", \"r-axis\"\n  ].reduce((acc, cur) => {\n      acc[cur] = {\n        pressed: `gamepad-${cur}-pressed`,\n        released: `gamepad-${cur}-released`\n      };\n      return acc;\n  }, {});\n  let controllers = {};\n  let keymaps = {};\n  let buttonstates = {};\n  let axisStates = {};\n  let axisCalibrations = {};\n\n  const initButtonStates = (keymap) =>\n    Object.keys(keymap).reduce((acc, cur) => {\n      acc[keymap[cur]] = false;\n      return acc;\n    }, {});\n\n  const roundOffAxisValue = (axis) =>\n    Math.round(axis * 100);\n\n  const calibrateAxisValue = (axis, calib) => {\n    if (axis === 1.0) { return 100; }\n    if (axis === -1.0) { return -100; }\n    const rounded = roundOffAxisValue(axis) - calib;\n    if (rounded < 20 && rounded > -20) { return 0; }\n    return rounded < 0 ? -50 : 50;\n  }\n\n  const registerController = (ev) => {\n    controllers[ev.gamepad.index] = ev.gamepad;\n    keymaps[ev.gamepad.index] = Object.assign({}, defaultMappings);\n    buttonstates[ev.gamepad.index] = initButtonStates(keymaps[ev.gamepad.index]);\n    axisStates[ev.gamepad.index] = ev.gamepad.axes.map(axis => roundOffAxisValue(axis));\n    axisCalibrations[ev.gamepad.index] = [];\n    if (onControllersChange) {\n      onControllersChange(Object.keys(controllers));\n    }\n  }\n\n  const removeController = ({gamepad}) => {\n    delete controllers[gamepad.index];\n    delete keymaps[gamepad.index];\n    delete buttonstates[gamepad.index];\n    delete axisStates[gamepad.index];\n    delete axisCalibrations[gamepad.index];\n    if (onControllersChange) {\n      onControllersChange(Object.keys(controllers));\n    }\n  }\n\n  function dispatchPadEvents() {\n    for (let idx in controllers) {\n      const controller = controllers[idx];\n      if (axisCalibrations[idx].length === 0) {\n        axisCalibrations[idx] = controller.axes.map(axis => roundOffAxisValue(axis))\n        axisStates[idx] = controller.axes.map((axis, j) =>\n          calibrateAxisValue(axis,  axisCalibrations[idx][j]));\n      }\n\n      for (let i in controller.axes) {\n        const current = calibrateAxisValue(controller.axes[i],  axisCalibrations[idx][i]);\n        if (current !== axisStates[idx][i]) {\n          const [axName, dir] = axisMappings[i];\n          if (dir === 0) {\n            window.dispatchEvent(new CustomEvent(\n              `gamepad-${axName}-x-change`, { detail: {\n                  controllerIndex: idx,\n                  force: current,\n                  measured: controller.axes[i],\n                  rounded: roundOffAxisValue(controller.axes[i])\n                }\n              })\n            );\n          } else {\n            window.dispatchEvent(new CustomEvent(\n              `gamepad-${axName}-y-change`,\n              {detail: {controllerIndex: idx, force: Math.abs(current), measured: controller.axes[i]}}\n            ));\n          }\n          axisStates[idx][i] = current;\n\n        }\n      }\n\n      for (let i in controller.buttons) {\n        const { pressed } = controller.buttons[i];\n        const buttonMapping = keymaps[idx][i];\n\n        if (buttonMapping && buttonstates[idx][buttonMapping] !== pressed) {\n          buttonstates[idx][buttonMapping] = pressed;\n          window.dispatchEvent(new CustomEvent(\n            padEvents[buttonMapping][pressed ? \"pressed\" : \"released\"],\n            {detail: {controllerIndex: idx}}\n          ));\n        }\n\n        if (onUnmappedButton && pressed && !buttonMapping) {\n          onUnmappedButton(i);\n        }\n      }\n    }\n    requestAnimationFrame(dispatchPadEvents);\n  }\n\n  dispatchPadEvents();\n\n  function scangamepads() {\n    var gamepads = navigator.getGamepads ? navigator.getGamepads() : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : []);\n    for (var i = 0; i < gamepads.length; i++) {\n      if (gamepads[i]) {\n        if (!(gamepads[i].index in controllers)) {\n          registerController({gamepad: gamepads[i]});\n        }\n      }\n    }\n  }\n  const haveEvents = 'ongamepadconnected' in window;\n  if (!haveEvents) {\n    setInterval(scangamepads, 50);\n  }\n\n  window.addEventListener(\"gamepadconnected\", registerController);\n  window.addEventListener(\"gamepaddisconnected\", removeController);\n  return Object.keys(padEvents)\n  .map(x => [`gamepad-${x}-pressed`, `gamepad-${x}-released`])\n  .reduce((a,b) => a.concat(b))\n  .concat([\n    \"gamepad-l-axis-x-change\", \"gamepad-l-axis-y-change\",\n    \"gamepad-r-axis-x-change\", \"gamepad-r-axis-y-change\"\n  ]);\n}\n\nmodule.exports = { initPadEvents: initPadEvents }\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import $$observable from 'symbol-observable';\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar ActionTypes = {\n  INIT: '@@redux/INIT' + Math.random().toString(36).substring(7).split('').join('.'),\n  REPLACE: '@@redux/REPLACE' + Math.random().toString(36).substring(7).split('').join('.')\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nfunction isPlainObject(obj) {\n  if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object' || obj === null) return false;\n\n  var proto = obj;\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\n/**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n  function getState() {\n    if (isDispatching) {\n      throw new Error('You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected the listener to be a function.');\n    }\n\n    if (isDispatching) {\n      throw new Error('You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n    }\n\n    var isSubscribed = true;\n\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error('You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n      }\n\n      isSubscribed = false;\n\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing what changed. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({ type: ActionTypes.REPLACE });\n  }\n\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if ((typeof observer === 'undefined' ? 'undefined' : _typeof(observer)) !== 'object' || observer === null) {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return { unsubscribe: unsubscribe };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  }\n\n  // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n  dispatch({ type: ActionTypes.INIT });\n\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n}\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionDescription = actionType && 'action \"' + String(actionType) + '\"' || 'an action';\n\n  return 'Given ' + actionDescription + ', reducer \"' + key + '\" returned undefined. ' + 'To ignore an action, you must explicitly return the previous state. ' + 'If you want this reducer to hold no value, you can return null instead of undefined.';\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return 'The ' + argumentName + ' has unexpected type of \"' + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + '\". Expected argument to be an object with the following ' + ('keys: \"' + reducerKeys.join('\", \"') + '\"');\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n\n  if (action && action.type === ActionTypes.REPLACE) return;\n\n  if (unexpectedKeys.length > 0) {\n    return 'Unexpected ' + (unexpectedKeys.length > 1 ? 'keys' : 'key') + ' ' + ('\"' + unexpectedKeys.join('\", \"') + '\" found in ' + argumentName + '. ') + 'Expected to find one of the known reducer keys instead: ' + ('\"' + reducerKeys.join('\", \"') + '\". Unexpected keys will be ignored.');\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, { type: ActionTypes.INIT });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined during initialization. ' + 'If the state passed to the reducer is undefined, you must ' + 'explicitly return the initial state. The initial state may ' + 'not be undefined. If you don\\'t want to set a value for this reducer, ' + 'you can use null instead of undefined.');\n    }\n\n    var type = '@@redux/PROBE_UNKNOWN_ACTION_' + Math.random().toString(36).substring(7).split('').join('.');\n    if (typeof reducer(undefined, { type: type }) === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined when probed with a random type. ' + ('Don\\'t try to handle ' + ActionTypes.INIT + ' or other actions in \"redux/*\" ') + 'namespace. They are considered private. Instead, you must return the ' + 'current state for any unknown actions, unless it is undefined, ' + 'in which case you must return the initial state, regardless of the ' + 'action type. The initial state may not be undefined, but can be null.');\n    }\n  });\n}\n\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\nfunction combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning('No reducer provided for key \"' + key + '\"');\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n  var finalReducerKeys = Object.keys(finalReducers);\n\n  var unexpectedKeyCache = void 0;\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError = void 0;\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var action = arguments[1];\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n    return hasChanged ? nextState : state;\n  };\n}\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(this, arguments));\n  };\n}\n\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if ((typeof actionCreators === 'undefined' ? 'undefined' : _typeof(actionCreators)) !== 'object' || actionCreators === null) {\n    throw new Error('bindActionCreators expected an object or a function, instead received ' + (actionCreators === null ? 'null' : typeof actionCreators === 'undefined' ? 'undefined' : _typeof(actionCreators)) + '. ' + 'Did you write \"import ActionCreators from\" instead of \"import * as ActionCreators from\"?');\n  }\n\n  var keys = Object.keys(actionCreators);\n  var boundActionCreators = {};\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var actionCreator = actionCreators[key];\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n  return boundActionCreators;\n}\n\n/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\n\nfunction compose() {\n  for (var _len = arguments.length, funcs = Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(undefined, arguments));\n    };\n  });\n}\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function () {\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      var store = createStore.apply(undefined, args);\n      var _dispatch = function dispatch() {\n        throw new Error('Dispatching while constructing your middleware is not allowed. ' + 'Other middleware would not be applied to this dispatch.');\n      };\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch() {\n          return _dispatch.apply(undefined, arguments);\n        }\n      };\n      var chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(undefined, chain)(store.dispatch);\n\n      return _extends({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning(\"You are currently using minified code outside of NODE_ENV === 'production'. \" + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { createStore, combineReducers, bindActionCreators, applyMiddleware, compose, ActionTypes as __DO_NOT_USE__ActionTypes };\n","import { createStore, combineReducers  } from 'redux';\nimport { initPadEvents } from \"padevents\";\n\nimport getFrameRenderer from \"./resizable-canvas/frame-renderer\";\nimport getResizeListeners from \"./resizable-canvas/resize-listeners\";\nimport initViewPort from \"./resizable-canvas/viewport\";\nimport getEventListeners from './resizable-canvas/event-listeners';\nimport { preload, drawPieuwer, drawBullet, drawEnemy, drawExplosion } from './draw';\n\nimport reducers from './store/reducers';\nimport { VIRT_HEIGHT, VIRT_WIDTH } from './store/constants';\n\nimport { keyActionCreator, bulletActionCreator, enemyActionCreator, explosionActionCreator } from './actions/action-creators';\nimport { ActionTypes } from './actions/action-types';\n\nimport { Point } from './phyz/shapes';\nimport { detectBulletToEnemyCollisions } from './phyz/collisions';\n\nconst store = createStore(combineReducers(reducers));\n\nconst { onKeyUp, onKeyDown, onGamePadButtonUp, onGamePadButtonDown } = keyActionCreator(store.dispatch);\nconst { spawnBullet } = bulletActionCreator(store.dispatch);\nconst { spawnEnemy, enemiesReceiveBullet } = enemyActionCreator(store.dispatch);\nconst { spawnExplosion } = explosionActionCreator(store.dispatch);\n\nconst mainLayer = document.getElementById(\"main-layer\");\nif (!(mainLayer instanceof HTMLCanvasElement)) { throw new TypeError(\"wrong element type\"); }\nconst mainLayerCtx = mainLayer.getContext(\"2d\");\nconst mainFrameRenderer = getFrameRenderer(mainLayerCtx, mainLayer);\n\n\nlet gamePadToPlayerMap : {[key : string] : \"pieuwerOne\"|\"pieuwerTwo\"} = {};\ninitPadEvents({\n  onUnmappedButton : () => { },\n  onControllersChange: (controllerIds : Array<string>) => {\n    if (controllerIds.length > 0 && typeof gamePadToPlayerMap[controllerIds[0]] === 'undefined') {\n      gamePadToPlayerMap[controllerIds[0]] = \"pieuwerOne\";\n    }\n    if (controllerIds.length > 1 && typeof gamePadToPlayerMap[controllerIds[1]] === 'undefined') {\n      gamePadToPlayerMap[controllerIds[1]] = \"pieuwerTwo\";\n    }\n  }\n});\n\nconst eventListeners = getEventListeners();\neventListeners.add(\"keydown\", (ev : KeyboardEvent) => { onKeyDown(ev.key); });\neventListeners.add(\"keyup\", (ev : KeyboardEvent) => { onKeyUp(ev.key); });\n['a', 'b', 'x', 'y'].forEach(k => {\n  eventListeners.add(`gamepad-${k}-pressed`, (ev : CustomEvent) => onGamePadButtonDown(\"a\", gamePadToPlayerMap[ev.detail.controllerIndex]));\n  eventListeners.add(`gamepad-${k}-released`, (ev : CustomEvent) => onGamePadButtonUp(\"a\", gamePadToPlayerMap[ev.detail.controllerIndex]));\n});\n['up', 'left', 'right', 'down'].forEach(k => {\n  eventListeners.add(`gamepad-${k}-pressed`, (ev : CustomEvent) => onGamePadButtonDown(k, gamePadToPlayerMap[ev.detail.controllerIndex]));\n  eventListeners.add(`gamepad-${k}-released`, (ev : CustomEvent) => onGamePadButtonUp(k, gamePadToPlayerMap[ev.detail.controllerIndex]));\n});\n\ninitViewPort(VIRT_WIDTH, VIRT_HEIGHT, getResizeListeners([mainLayer],\n  eventListeners.onResize,\n  mainFrameRenderer.onResize\n));\n\nconst debug = document.getElementById(\"debug\");\n\nconst handleBulletEnemyCollision = (params : {bulletIdx : number, enemies: Array<number>, collsionPos : Point}) => {\n  enemiesReceiveBullet(params);\n  spawnExplosion(params.collsionPos, 5)\n}\n\nconst game = () => {\n  const renderLoop = () => {\n    const { pieuwerStates, bulletStates, enemyStates, explosionStates } = store.getState();\n  //  debug.innerHTML = JSON.stringify(store.getState().enemyStates.collisionGrid, null, 2);\n\n    mainFrameRenderer.clear();\n    mainFrameRenderer.render([\n        drawPieuwer(\"pieuwerOne\", pieuwerStates.pieuwerOne),\n        drawPieuwer(\"pieuwerTwo\", pieuwerStates.pieuwerTwo),\n      ].concat(\n      bulletStates.bullets.map(drawBullet)).concat(\n      enemyStates.enemies.map(drawEnemy)).concat(\n      explosionStates.explosions.map(drawExplosion)\n    ));\n  \trequestAnimationFrame(renderLoop);\n  };\n\n\n  for (let i = 0; i < 16; i++) {\n    spawnEnemy(i * 100, 150, {x: 60, y: 80});\n    spawnEnemy(i * 100 + 50, 250, {x: 60, y: 80});\n  }\n  spawnEnemy(200, 200, {x: 200, y: 320}, 100);\n  spawnEnemy(600, 200, {x: 200, y: 320}, 100);\n  spawnEnemy(1000, 200, {x: 200, y: 320}, 100);\n\n  const updateLoop = () => {\n    detectBulletToEnemyCollisions(store.getState())\n      .forEach(handleBulletEnemyCollision)\n\n    store.dispatch({type: ActionTypes.UPDATE});\n  }\n\n  window.setInterval(updateLoop, 10);\n  window.setInterval(() => {\n    const { pieuwerOne, pieuwerTwo } = store.getState().pieuwerStates;\n    spawnBullet(pieuwerOne);\n    spawnBullet(pieuwerTwo);\n  }, 50);\n\n  renderLoop();\n};\n\npreload(game);\n"],"sourceRoot":""}